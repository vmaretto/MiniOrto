# MyFreshFood - Sessione 3 Febbraio 2026

## Modifiche principali fatte oggi

### 1. Riconoscimento alimenti esteso
- Esteso da solo frutta/verdura a TUTTI gli alimenti (latticini, cereali, proteine, bevande)
- File: `api/recognize-product.js`

### 2. API SWITCH - Matching semantico
- Aggiunto matching semantico per varianti alimenti:
  - "yogurt greco/bianco" → YOGURT
  - "latte intero/scremato" → COW MILK
  - "pomodoro ciliegino" → TOMATO
  - etc.
- Esclusi item senza nome dal DB
- File: `api/switch-lookup.js`

### 3. REGOLA FONDAMENTALE: Solo dati DB SWITCH
- **MAI usare fallback hardcoded**
- **MAI inventare dati con AI**
- Tutti i dati nutrizionali e ambientali DEVONO venire dall'API SWITCH
- Se non trova → mostra N/A, non dati inventati
- Rimossi: water, vitaminC (non nel DB SWITCH per tutti i prodotti)

### 4. ProductCard - Ristrutturata
- **Valori Nutrizionali**: solo da DB SWITCH (calories, protein, carbs, fat, fiber, sugar)
- **Impatto Ambientale**: integrato dentro ProductCard (non più separato)
- Mostra sempre **quale alimento ha matchato** ("Dati per: YOGURT")
- Info aggiuntive (stagionalità, tips, abbinamenti) → OK da AI
- File: `src/components/ProductCard.js`

### 5. Nuovo flusso pagine
**Ordine corretto:**
1. Quiz → utente fa stime
2. Scansione completata → bottone "Vai alla Scheda Prodotto"
3. **Scheda Prodotto** (`/results`) → mostra ProductCard completa
4. Bottone "Vedi Confronto Stime vs Realtà"
5. **Confronto Risultati** (`/comparison`) → tabella 3 colonne

### 6. ComparisonScreen - Nuova pagina
- Tabella a 3 colonne: **Stima Utente | Misurato (SCIO) | DB SWITCH**
- N/A dove manca il valore
- Punteggio calcolato confrontando stima con valore disponibile (misurato O DB)
- File: `src/screens/ComparisonScreen.js`

### 7. Fonti dati - Chiarimento
| Dato | Fonte |
|------|-------|
| Calorie, Proteine, Carboidrati, Grassi, Fibre, Zuccheri | DB SWITCH |
| CO₂, Impronta idrica, Punteggio ambientale | DB SWITCH |
| Stagionalità, Tips, Abbinamenti, Curiosità | AI (Claude) |
| Valori misurati (se SCIO usato) | SCIO device |

### 8. File modificati
- `api/recognize-product.js` - riconoscimento esteso
- `api/switch-lookup.js` - matching semantico, no item vuoti
- `src/components/ProductCard.js` - solo dati SWITCH, impatto ambientale integrato
- `src/components/EnvironmentalCard.js` - mostra matchedItem
- `src/screens/ResultsScreen.js` - mostra ProductCard prima, poi bottone confronto
- `src/screens/ComparisonScreen.js` - NUOVA, tabella 3 colonne
- `src/screens/QuizScreen.js` - rimossi fallback
- `src/screens/ScanFlowScreen.js` - porta a /results (Scheda Prodotto)
- `src/App.js` - aggiunta route /comparison

## Repo e Deploy
- GitHub: github.com/vmaretto/MiniOrto
- Virgilio fa git pull sul MacBook Air per testare
- Deploy Vercel dopo test locale

## Prossimi passi (da confermare con Virgilio)
- [ ] Test completo del flusso
- [ ] Verifica valori DB SWITCH corretti
- [ ] Deploy su Vercel
